CREATE VIEW product_sales AS
SELECT 
    p.product_id,
    p.name,
    c.name as category,
    SUM(oi.quantity) as total_units_sold,
    SUM(oi.subtotal) as total_revenue
FROM products p
JOIN categories c ON p.category_id = c.category_id
LEFT JOIN order_items oi ON p.product_id = oi.product_id
GROUP BY p.product_id, p.name, c.name; 
